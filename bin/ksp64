#!/bin/bash

ksp="$HOME/Library/Application Support/Steam/SteamApps/common/Kerbal Space Program/KSP.app/Contents"
unity="/Applications/Unity/Unity.app/Contents/PlaybackEngines/MacStandaloneSupport/Variations/macosx64_nondevelopment_mono/UnityPlayer.app/Contents"

transfer() {
  mv "$ksp/$1" "$ksp/$1.bak" || { echo "couldn't move $1 out of the way" >&2; exit 1; }
  cp "$unity/$1" "$ksp/$1" || { echo "couldn't copy $1" >&2; exit 2; }
}

transfer "Data/Managed/UnityEngine.dll"
transfer "Frameworks/MonoEmbedRuntime/osx/libmono.0.dylib"
transfer "Frameworks/MonoEmbedRuntime/osx/libMonoPosixHelper.dylib"

mv "$ksp/MacOS/KSP" "$ksp/MacOS/KSP.bak" || { echo "couldn't move MacOS/KSP out of the way" >&2; exit 3; }
cp "$unity/MacOS/UnityPlayer" "$ksp/MacOS/KSP" || { echo "couldn't copy MacOS/UnityPlayer" >&2; exit 4; }
